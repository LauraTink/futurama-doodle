<ng-container *ngIf="error || loading; else showQuiz">
  <mat-progress-bar *ngIf="loading && !error" mode="indeterminate"></mat-progress-bar>

  <app-error *ngIf="error && !loading" [errorMessage]="error"></app-error>
</ng-container>

<ng-template #showQuiz>
  <div fxFill fxLayout="row" fxLayoutAlign="center start">
    <div fxFlex fxFlex.gt-sm="70" fxLayout="column" fxLayoutGap="48px">

      <div *ngIf="finished; else questions" fxLayout="column" fxLayoutAlign="start center" fxLayoutGap="24px">
        <mat-progress-spinner color="primary" mode="determinate"
          [value]="((userScore.score / userScore.totalQuestions ) * 100).toFixed(0)">
        </mat-progress-spinner>
        <h1>
          You got {{ userScore.score }} out of {{ userScore.totalQuestions }} right
        </h1>

        <button mat-flat-button color="primary" (click)="reset()">Retry</button>
      </div>

      <ng-template #questions>
        <div fxLayoutAlign="center center" class="question">
          <h1>{{ question.question }}</h1>
        </div>

        <div fxFill fxLayout="column" fxLayout.gt-sm="row" fxLayoutAlign.gt-sm="center start">
          <mat-card *ngFor="let option of question.possibleAnswers" fxFlex class="question-card"
            (click)="checkAnswer(option)">
            {{ option }}
          </mat-card>
        </div>

        <div fxFill fxLayoutAlign="center center">
          <h2> {{ userScore.questionsAnswered }} out of {{ userScore.totalQuestions }} answered </h2>
        </div>
      </ng-template>
    </div>
  </div>

  <button mat-fab color="primary" matTooltip="Return to overview" (click)="navigate()">
    <mat-icon>
      arrow_back
    </mat-icon>
  </button>
</ng-template>
